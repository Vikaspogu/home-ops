---
# Example Velero Schedule for PVC backups
# This matches the settings from velero-backup-pvcs.sh script
# Note: Kyverno policy auto-generates these for namespaces with label velero-backup-pvc=true
apiVersion: velero.io/v1
kind: Schedule
metadata:
  name: default-namespace-pvc
  namespace: storage
  labels:
    backup_type: pvc_fsb
spec:
  # Run backup every 6 hours
  schedule: "0 */6 * * *"
  useOwnerReferencesInBackup: false
  template:
    # 2 days retention
    ttl: 48h
    # Storage location (matches velero-backup-pvcs.sh default: BACKUP_STORAGE_LOCATION=default)
    storageLocation: default
    # Backup all resources in the namespace
    includedNamespaces:
      - default
    # Enable File System Backup to capture actual PVC data
    # This is the key setting from: --default-volumes-to-fs-backup=true
    defaultVolumesToFsBackup: true
