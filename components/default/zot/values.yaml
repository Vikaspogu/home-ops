---
controllers:
  main:
    annotations:
      reloader.stakater.com/auto: "true"

    pod:
      securityContext:
        runAsUser: 1000
        runAsGroup: 1000
        fsGroup: 1000
        fsGroupChangePolicy: OnRootMismatch
        supplementalGroups:
          - 568

    containers:
      main:
        image:
          repository: ghcr.io/project-zot/zot
          tag: v2.1.13@sha256:d3cde44fa759bf7f3d25b479e2b33ed5d4d3f1d6fdad01b204d15a9c3af2db3c
          pullPolicy: IfNotPresent
        args:
          - serve
          - /etc/zot/config.yaml
        probes:
          liveness: &probe
            enabled: true
            custom: true
            spec:
              httpGet:
                path: /v2/
                port: 5000
              initialDelaySeconds: 5
          readiness: *probe
          startup:
            enabled: false

service:
  main:
    controller: main
    ports:
      http:
        port: &port 5000

persistence:
  config:
    enabled: true
    type: secret
    name: zot
    globalMounts:
      - path: /etc/zot/config.yaml
        subPath: config.yaml
  registry:
    existingClaim: zot
    globalMounts:
      - path: /var/lib/registry
  tmp-zot:
    enabled: true
    type: emptyDir
    sizeLimit: 1Gi
    globalMounts:
      - path: /tmp
