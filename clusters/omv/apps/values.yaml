default:
  app:
    enabled: true
    enableAutoSync: true
    autoSyncPrune: true
    project: default
    finalizers:
      - resources-finalizer.argocd.argoproj.io
    labels:
      app-source: omv
      repo: default
    destination:
      server: https://kubernetes.default.svc
    source:
      repoURL: https://github.com/Vikaspogu/home-ops.git
      targetRevision: HEAD
    syncPolicy:
      automated:
        allowEmpty: true
        prune: true
        selfHeal: true
      retry:
        limit: 10
        backoff:
          duration: 10s
          factor: 2
          maxDuration: 3m
    syncOptions:
      - ApplyOutOfSyncOnly=true
      - PrunePropagationPolicy=foreground
      - PruneLast=true
      - ServerSideApply=true
      - FailOnSharedResource=true
      - RespectIgnoreDifferences=true
      - CreateNamespace=false


applications:

  external-secrets-chart:
    annotations:
      argocd.argoproj.io/sync-wave: "0"
    destination:
      namespace: external-secrets
    source:
      path: components/external-secrets/external-secrets-chart

  onepassword-connect:
    annotations:
      argocd.argoproj.io/sync-wave: "0"
    destination:
      namespace: external-secrets
    source:
      path: components/external-secrets/onepassword-connect

  external-secrets-stores:
    annotations:
      argocd.argoproj.io/sync-wave: "10"
    destination:
      namespace: external-secrets
    source:
      path: components/external-secrets/external-secrets-stores

  cert-manager:
    annotations:
      argocd.argoproj.io/sync-wave: "15"
    destination:
      namespace: cert-manager
    source:
      path: clusters/omv/apps/cert-manager/cert-manager

  traefik:
    annotations:
      argocd.argoproj.io/sync-wave: "15"
    destination:
      namespace: kube-system
    source:
      path: components/kube-system/traefik

  unifi-dns:
    annotations:
      argocd.argoproj.io/sync-wave: "20"
    destination:
      namespace: network
    source:
      path: components/network/unifi-dns

  argo-cd:
    annotations:
      argocd.argoproj.io/sync-wave: "20"
    destination:
      namespace: argo-system
    source:
      path: clusters/omv/apps/argo-system/argo-cd

  longhorn:
    annotations:
      argocd.argoproj.io/sync-wave: "20"
    destination:
      namespace: longhorn-system
    source:
      path: components/longhorn-system/longhorn

  snapshot-controller:
    annotations:
      argocd.argoproj.io/sync-wave: "20"
    destination:
      namespace: kube-system
    source:
      path: components/kube-system/snapshot-controller

  rancher:
    annotations:
      argocd.argoproj.io/sync-wave: "25"
    destination:
      namespace: cattle-system
    source:
      path: components/cattle-system/rancher

  garage-app:
    annotations:
      argocd.argoproj.io/sync-wave: "25"
    destination:
      namespace: default
    source:
      path: components/default/garage-app

  bytestash:
    annotations:
      argocd.argoproj.io/sync-wave: "25"
    destination:
      namespace: default
    source:
      path: components/default/bytestash

  homepage:
    annotations:
      argocd.argoproj.io/sync-wave: "25"
    destination:
      namespace: default
    source:
      path: components/default/homepage

  syncthing:
    annotations:
      argocd.argoproj.io/sync-wave: "25"
    destination:
      namespace: default
    source:
      path: components/default/syncthing

  reloader:
    annotations:
      argocd.argoproj.io/sync-wave: "25"
    destination:
      namespace: kube-system
    source:
      path: components/kube-system/reloader

  kopia:
    annotations:
      argocd.argoproj.io/sync-wave: "25"
    destination:
      namespace: volsync-system
    source:
      path: clusters/omv/apps/volsync-system/kopia

  volsync:
    annotations:
      argocd.argoproj.io/sync-wave: "25"
    destination:
      namespace: volsync-system
    source:
      path: clusters/omv/apps/volsync-system/volsync

  barman-cloud:
    annotations:
      argocd.argoproj.io/sync-wave: "25"
    destination:
      namespace: default
    source:
      path: components/default/barman-cloud

  cloudnative-pg:
    annotations:
      argocd.argoproj.io/sync-wave: "25"
    destination:
      namespace: default
    source:
      path: components/default/cloudnative-pg

  cloudnative-cluster:
    annotations:
      argocd.argoproj.io/sync-wave: "30"
    destination:
      namespace: default
    source:
      path: components/default/cloudnative-cluster

  rwmarkable:
    annotations:
      argocd.argoproj.io/sync-wave: "35"
    destination:
      namespace: default
    source:
      path: components/default/rwmarkable
      plugin:
        env:
          - name: STORAGE_CLASS
            value: longhorn
          - name: VOLUME_SNAPSHOT_CLASS
            value: longhorn
          - name: CACHE_SIZE
            value: 4Gi
          - name: PVC_SIZE
            value: 2Gi

  system-upgrade-controller:
    annotations:
      argocd.argoproj.io/sync-wave: "45"
    destination:
      namespace: system-upgrade
    source:
      path: components/system-upgrade/system-upgrade-controller

  system-upgrade-k3s:
    annotations:
      argocd.argoproj.io/sync-wave: "45"
    destination:
      namespace: system-upgrade
    source:
      path: components/system-upgrade/k3s
