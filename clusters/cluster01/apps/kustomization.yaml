apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

helmGlobals:
  chartHome: ../../../helm/charts

helmCharts:
  - name: argocd-app-of-app
    valuesInline:
      default:
        app:
          enabled: true
          enableAutoSync: true
          autoSyncPrune: true
          project: default
          labels:
            app-source: cluster01
            repo: default
          destination:
            namespace: argo-system
            server: https://kubernetes.default.svc
          source:
            repoURL: https://github.com/Vikaspogu/home-ops.git
            targetRevision: HEAD
          syncOptions:
            - ApplyOutOfSyncOnly=true
            - PrunePropagationPolicy=foreground
            - PruneLast=true
            - ServerSideApply=true
            - FailOnSharedResource=true
            - RespectIgnoreDifferences=true
            - CreateNamespace=false
          syncPolicyRetry:
            limit: -1
            backoff:
              duration: 5s
              factor: 2
              maxDuration: 10m
    additionalValuesFiles:
      - ./values.yaml
    namespace: argo-system

patches: []
